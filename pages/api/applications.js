import dbConnect from "@/lib/dbConnect"; import Application from "@/lib/Application"; export default async function handler(req, res) { await dbConnect(); try { switch (req.method) { case "GET": { const apps = await Application.find().sort({createdAt: -1}); return res.status(200).json({success: true, data: apps}); } case "POST": { const app = await Application.create(req.body); return res.status(201).json({success: true, data: app}); } case "PUT": { const {id} = req.query; const updated = await Application.findByIdAndUpdate(id, req.body, {new: true}); if (!updated) return res.status(404).json({success: false, error: "Not found"}); return res.status(200).json({success: true, data: updated}); } case "DELETE": { const {id} = req.query; const deleted = await Application.findByIdAndDelete(id); if (!deleted) return res.status(404).json({success: false, error: "Not found"}); return res.status(200).json({success: true}); } default: return res.status(405).json({success: false, error: "Method not allowed"}); } } catch (error) { return res.status(500).json({success: false, error: error.message || "Server Error"}); } }
