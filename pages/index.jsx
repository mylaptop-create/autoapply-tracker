import { useEffect, useState } from "react"; const statusColors = {Applied: "bg-blue-100 text-blue-700", Interview: "bg-yellow-100 text-yellow-700", Offer: "bg-green-100 text-green-700", Rejected: "bg-red-100 text-red-700"}; export default function Home() { const [apps, setApps] = useState([]); const [form, setForm] = useState({company: "", position: "", salary: "", status: "Applied", appliedDate: "", notes: ""}); const [search, setSearch] = useState(""); const [filter, setFilter] = useState("All"); useEffect(() => { fetchApps(); }, []); async function fetchApps() { const res = await fetch("/api/applications"); const json = await res.json(); setApps(json.data || []); } async function submitForm(e) { e.preventDefault(); await fetch("/api/applications", {method: "POST", headers: {"Content-Type": "application/json"}, body: JSON.stringify(form)}); setForm({company: "", position: "", salary: "", status: "Applied", appliedDate: "", notes: ""}); fetchApps(); } async function deleteApp(id) { if (!confirm("Delete this application?")) return; await fetch(`/api/applications?id=${id}`, {method: "DELETE"}); fetchApps(); } const filteredApps = apps.filter((a) => a.company.toLowerCase().includes(search.toLowerCase()) || a.position.toLowerCase().includes(search.toLowerCase())).filter((a) => (filter === "All" ? true : a.status === filter)); return (<div className="min-h-screen bg-gradient-to-br from-indigo-600 to-purple-700 p-6"><div className="max-w-7xl mx-auto bg-white rounded-2xl p-8 shadow-2xl"><h1 className="text-4xl font-bold mb-8 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Job Application Tracker</h1><div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">{["Applied", "Interview", "Offer", "Rejected"].map((s) => (<div key={s} className="p-4 rounded-xl bg-gradient-to-br from-gray-50 to-gray-100 border border-gray-200 hover:shadow-lg transition"><p className="text-sm text-gray-500 font-medium">{s}</p><p className="text-3xl font-bold text-gray-800">{apps.filter((a) => a.status === s).length}</p></div>))}</div><form onSubmit={submitForm} className="grid md:grid-cols-3 gap-4 mb-8 p-6 bg-gray-50 rounded-xl border border-gray-200"><input required placeholder="Company" className="w-full border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" value={form.company} onChange={(e) => setForm({...form, company: e.target.value})}/><input required placeholder="Position" className="w-full border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" value={form.position} onChange={(e) => setForm({...form, position: e.target.value})}/><input placeholder="Salary" type="number" className="w-full border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" value={form.salary} onChange={(e) => setForm({...form, salary: e.target.value})}/><select className="w-full border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" value={form.status} onChange={(e) => setForm({...form, status: e.target.value})}>{Object.keys(statusColors).map((s) => (<option key={s}>{s}</option>))}</select><input required type="date" className="w-full border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition" value={form.appliedDate} onChange={(e) => setForm({...form, appliedDate: e.target.value})}/><button type="submit" className="bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg px-6 py-2.5 font-semibold hover:shadow-lg transition md:col-span-3">+ Add Application</button></form><div className="flex flex-col md:flex-row gap-4 mb-6"><input placeholder="Search..." className="flex-1 border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500" value={search} onChange={(e) => setSearch(e.target.value)}/><select className="w-full md:w-48 border border-gray-300 rounded-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-indigo-500" value={filter} onChange={(e) => setFilter(e.target.value)}><option>All</option>{Object.keys(statusColors).map((s) => (<option key={s}>{s}</option>))}</select></div><div className="overflow-x-auto"><table className="w-full text-left text-sm"><thead className="bg-gray-100 border-b-2 border-gray-300"><tr><th className="p-4 font-semibold text-gray-700">Company</th><th className="p-4 font-semibold text-gray-700">Position</th><th className="p-4 font-semibold text-gray-700">Salary</th><th className="p-4 font-semibold text-gray-700">Status</th><th className="p-4 font-semibold text-gray-700">Date</th><th className="p-4 font-semibold text-gray-700">Action</th></tr></thead><tbody>{filteredApps.map((a) => (<tr key={a._id} className="border-b hover:bg-gray-50 transition"><td className="p-4 text-gray-800 font-medium">{a.company}</td><td className="p-4 text-gray-700">{a.position}</td><td className="p-4 text-gray-700">${a.salary || "N/A"}</td><td className="p-4"><span className={`px-3 py-1 rounded-full text-xs font-semibold ${statusColors[a.status]}`}>{a.status}</span></td><td className="p-4 text-gray-600">{new Date(a.appliedDate).toLocaleDateString()}</td><td className="p-4"><button onClick={() => deleteApp(a._id)} className="text-red-500 hover:text-red-700 font-semibold hover:underline transition">Delete</button></td></tr>))}{filteredApps.length === 0 && (<tr><td colSpan="6" className="p-6 text-center text-gray-400">No applications found</td></tr>)}</tbody></table></div></div></div>);}
